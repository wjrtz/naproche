start: element*

element: directive
       | environment
       | sentence

directive: read_directive | prover_directive | cache_directive

read_directive: "[" "read" path "]"
prover_directive: "[" "prover" word "]"
cache_directive: "[" "cache" word "]"

path: "\\path{" /[^}]+/ "}"

environment: BEGIN "{" env_name "}" optional_arg? element* END "{" env_name "}"

BEGIN.2: "\\begin"
END.2: "\\end"

env_name: /[a-zA-Z*]+/
optional_arg: "[" /[^\]]+/ "]"

sentence: atom+ "."

atom: math | word | other_symbol | punctuation

math: INLINE_MATH | DISPLAY_MATH
INLINE_MATH: "$" /[^$]+/ "$"
DISPLAY_MATH: "\\[" /(.|\n)+?/ "\\]"

word: /[a-zA-Z0-9_]+/
other_symbol: /[^\s\w$.\[\]\\{}]+/ | BACKSLASH | BRACE_OPEN | BRACE_CLOSE | BRACKET_OPEN | BRACKET_CLOSE
punctuation: "," | ":" | ";"

BACKSLASH: "\\"
BRACE_OPEN: "{"
BRACE_CLOSE: "}"
BRACKET_OPEN: "["
BRACKET_CLOSE: "]"

COMMENT: "%" /[^\n]*/
%import common.WS
%ignore WS
%ignore COMMENT
